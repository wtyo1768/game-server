{"version":3,"sources":["webpack:///./src/views/BeginnerCollect.vue?bf14","webpack:///./src/views/BeginnerCollect.vue?912c","webpack:///src/views/BeginnerCollect.vue","webpack:///./src/views/BeginnerCollect.vue?0ded","webpack:///./src/views/BeginnerCollect.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_BeginnerCollect_vue_vue_type_style_index_0_id_65bb8582_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_BeginnerCollect_vue_vue_type_style_index_0_id_65bb8582_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","isCatchLocation","attrs","id","width","height","playsinline","autoplay","muted","loop","domProps","src","type","staticStyle","font-weight","_v","class","pointer-active","userData","isBeginner","style","pointer-events","user","collectionInfo","isCollectable","on","collect","ifCollectable","currentScenes","planet","nextScenes","_e","close","closeReport","staticRenderFns","BeginnerCollectvue_type_script_lang_js_","name","components","CollectPanel","CustomDialog","Dialog","CollectReport","data","isCollecting","mymap","watcher","options","enableHighAccuracy","timeout","maximumAge","distanceFilter","lat","lng","marker","geojson","locationGridArr","undefined","module","robotIsOpen","actions","beginner_guide_info","beforeMount","navigator","geolocation","getCurrentPosition","drawMap","error","created","_this","Promise","resolve","then","bind","_ref","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","gameFunction","scene","input","manager","enabled","stop","_x","apply","arguments","beforeDestroy","computed","objectSpread","vuex_esm","state","mapGridData","getRespawnTime","methods","pos","_this2","setTimeout","coords","latitude","longitude","remove","leaflet_src_default","a","map","center","zoom","zoomControl","tileLayer","maxZoom","minZoom","errorTilrUrl","accessToken","addTo","myIcon","icon","iconUrl","iconSize","iconAnchor","className","drawGeoJSON","err","console","warn","code","message","updateError","geoJSON","createVisiableAreaData","onEachFeature","i","length","updateLocalGeoJson","_this3","clearLayers","CHECK_USER_COOLDOWN","FILTER_MAPGRIDDATA","maxLat","Math","ceil","maxLng","gap","range","floor","detectRange","_loop","j","checkLat","round","checkLng","gridData","find","ele","properties","push","basicGrid","density","respawnTime","storages","amount","geometry","coordinates","feature","remainStorage","fillColor","getColor","weight","opacity","color","dashArray","fillOpacity","d","highlightFeature","e","layer","target","fitBounds","getBounds","setStyle","Browser","ie","opera","edge","bringToFront","click","collectorAmount","collectorMax","coolDownGrid","log","status","some","collectCoolDown","finishTime","Date","now","storageToResource","newGrid","ADD_GRIDDATA","centerOn","_storageToResource","_callee2","resources","_context2","forEach","storage","index","addAmount","collectAbility","collectWeights","weights","COST_RESOURCES","$store","dispatch","addData","_x2","panTo","_this4","time","action","NEXT_SCENES","$router","views_BeginnerCollectvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-2f99c2fa.53d15bea.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BeginnerCollect.vue?vue&type=style&index=0&id=65bb8582&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BeginnerCollect.vue?vue&type=style&index=0&id=65bb8582&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"collect-root\"},[(_vm.isCatchLocation === 0)?_c('div',{staticClass:\"cover-layer\",attrs:{\"id\":\"scan-anim-layer\"}},[_c('video',{attrs:{\"width\":\"350\",\"height\":\"360\",\"playsinline\":\"\",\"autoplay\":\"\",\"muted\":\"\",\"loop\":\"\"},domProps:{\"muted\":true}},[_c('source',{attrs:{\"src\":require(\"../assets/video/collect/scanning.mp4\"),\"type\":\"video/mp4\"}})]),_c('div',{staticStyle:{\"font-weight\":\"700\"}},[_vm._v(\"掃描地表資源中...\")])]):_c('collect-panel',{class:{'pointer-active': _vm.userData.isBeginner},style:({'pointer-events': _vm.userData.isBeginner ? 'none' : 'all'}),attrs:{\"user\":_vm.userData,\"collectionInfo\":_vm.collectionInfo,\"isCollectable\":_vm.isCollectable},on:{\"collect\":_vm.ifCollectable}}),(_vm.userData.isBeginner && _vm.isCatchLocation === 1)?_c('custom-dialog',{staticClass:\"dialog\",attrs:{\"currentScenes\":_vm.currentScenes,\"planet\":_vm.planet},on:{\"nextScenes\":_vm.nextScenes}}):_vm._e(),_c('div',{attrs:{\"id\":\"mapid\"}}),(_vm.isCollecting)?_c('collect-report',{on:{\"close\":_vm.closeReport}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\r\n  div(class=\"collect-root\")\r\n    div(v-if=\"isCatchLocation === 0\" id=\"scan-anim-layer\" class=\"cover-layer\")\r\n        video(width=\"350\" height=\"360\" playsinline autoplay muted loop)\r\n          source(src=\"../assets/video/collect/scanning.mp4\" type=\"video/mp4\")\r\n        //- img(src=\"../assets/video/collect/scanning.gif\")\r\n        div(style=\"font-weight: 700\") 掃描地表資源中...\r\n    //- div(v-else-if=\"isCatchLocation === -1\" id=\"error-layer\" class=\"cover-layer\")\r\n    //-   div 抓不到定位，請檢查裝置定位\r\n    //-   router-link(tag=\"div\" to=\"/game\" style=\"font-weight: 700\") 回到遊戲主畫面\r\n    collect-panel(\r\n      v-else\r\n      @collect=\"ifCollectable\"\r\n      :user=\"userData\"\r\n      :collectionInfo=\"collectionInfo\"\r\n      :isCollectable=\"isCollectable\"\r\n      :style=\"{'pointer-events': userData.isBeginner ? 'none' : 'all'}\"\r\n      :class=\"{'pointer-active': userData.isBeginner}\")\r\n    custom-dialog(\r\n      v-if=\"userData.isBeginner && isCatchLocation === 1\"\r\n      class=\"dialog\"\r\n      :currentScenes=\"currentScenes\"\r\n      :planet=\"planet\"\r\n      @nextScenes=\"nextScenes\")\r\n    div(id=\"mapid\")\r\n    collect-report(v-if=\"isCollecting\" @close=\"closeReport\")\r\n</template>\r\n\r\n<script>\r\nimport L from 'leaflet'\r\nimport CustomDialog from '@/components/beginnerGuide/Dialog.vue'\r\nimport CollectPanel from '@/components/game/collect/CollectPanel.vue'\r\nimport CollectReport from '@/components/game/collect/CollectReport.vue'\r\nimport { mapState, mapGetters, mapMutations, mapActions } from 'vuex'\r\nimport beginnerGuideInfo from '@/assets/data/beginner-guide-info.json'\r\n\r\nexport default {\r\n  name: 'Collect',\r\n  components: {\r\n    CollectPanel,\r\n    CustomDialog,\r\n    CollectReport\r\n  },\r\n  data: function () {\r\n    return {\r\n      isCollecting: false,\r\n      isCatchLocation: 0,\r\n      mymap: null,\r\n      watcher: null,\r\n      options: {\r\n        enableHighAccuracy: false,\r\n        timeout: 10000,\r\n        maximumAge: 0,\r\n        distanceFilter: 1\r\n      },\r\n      lat: null,\r\n      lng: null,\r\n      marker: null,\r\n      geojson: null,\r\n      locationGridArr: [],\r\n      collectionInfo: undefined,\r\n      isCollectable: false,\r\n      module: null,\r\n      robotIsOpen: true,\r\n      actions: beginnerGuideInfo.actions\r\n    }\r\n  },\r\n  beforeMount: function () {\r\n    navigator.geolocation.getCurrentPosition(this.drawMap, this.error, this.options)\r\n    // this.watcher = navigator.geolocation.watchPosition(this.update, this.updateError, this.options)\r\n  },\r\n  created: function () {\r\n    import('@/game/scenes/PlayScene').then(async (module) => {\r\n      this.module = module\r\n      this.module.gameFunction.scene.input.manager.enabled = false\r\n    })\r\n  },\r\n  beforeDestroy: function () {\r\n    // navigator.geolocation.clearWatch(this.watcher)\r\n    this.module.gameFunction.scene.input.manager.enabled = true\r\n  },\r\n  computed: {\r\n    ...mapState('user', {\r\n      userData: state => state\r\n    }),\r\n    ...mapState('planet', {\r\n      planet: state => state.planet\r\n    }),\r\n    ...mapGetters('user', {\r\n      currentScenes: 'getCurrentBeginnerGuideScenes'\r\n    }),\r\n    ...mapGetters('map', {\r\n      mapGridData: 'getMapGridData',\r\n      getRespawnTime: 'getRespawnTime'\r\n    })\r\n  },\r\n  methods: {\r\n    ...mapMutations('user', ['CHECK_USER_COOLDOWN', 'NEXT_SCENES']),\r\n    ...mapActions('user', ['collectCoolDown']),\r\n    ...mapMutations('map', ['FILTER_MAPGRIDDATA', 'ADD_GRIDDATA', 'COST_RESOURCES']),\r\n    ...mapActions('map', ['costResources', 'respawnGridData']),\r\n    drawMap (pos) {\r\n      setTimeout(() => {\r\n        this.isCatchLocation = 1\r\n      }, 2000)\r\n\r\n      this.lat = pos.coords.latitude\r\n      this.lng = pos.coords.longitude\r\n      if (this.mymap) { this.mymap.remove() }\r\n      this.mymap = L.map('mapid', {\r\n        center: [this.lat, this.lng],\r\n        zoom: 16,\r\n        zoomControl: false\r\n      })\r\n      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {\r\n        // attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n        maxZoom: 18,\r\n        minZoom: 8,\r\n        errorTilrUrl: 'http://bpic.588ku.com/element_pic/16/12/07/706f7ff4f15725b17ba1d30d384e6468.jpg',\r\n        id: 'mapbox.streets',\r\n        accessToken: 'pk.eyJ1IjoibGVva3VvMDcyNCIsImEiOiJjanZ6YzltbXUwcDVoM3pyNmI0aGp5N29tIn0.xjdaery7ZqnxkZhbktidYQ'\r\n      }).addTo(this.mymap)\r\n\r\n      let myIcon = L.icon({\r\n        iconUrl: require('@/assets/marker.png'),\r\n        iconSize: [54, 56],\r\n        iconAnchor: [27, 56],\r\n        className: 'marker-icon'\r\n        // popupAnchor: [-3, -76]\r\n        // shadowUrl: 'my-icon-shadow.png',\r\n        // shadowSize: [68, 95],\r\n        // shadowAnchor: [22, 94]\r\n      })\r\n\r\n      this.marker = L.marker([this.lat, this.lng], { icon: myIcon }).addTo(this.mymap)\r\n      this.drawGeoJSON()\r\n    },\r\n    error (err) {\r\n      console.warn('ERROR(' + err.code + '): ' + err.message)\r\n      this.isCatchLocation = -1\r\n      // 以下為測試用\r\n      let pos = {\r\n        coords: {\r\n          longitude: 120.21575,\r\n          latitude: 22.99962\r\n        }\r\n      }\r\n      this.drawMap(pos)\r\n    },\r\n    updateError (err) {\r\n      console.warn('ERROR(' + err.code + '): ' + err.message)\r\n    },\r\n    // update (pos) {\r\n    //   this.lat = pos.coords.latitude\r\n    //   this.lng = pos.coords.longitude\r\n    //   this.marker.setLatLng([this.lat, this.lng])\r\n\r\n    //   if (this.geojson) {\r\n    //     this.geojson.addData(this.createVisiableAreaData())\r\n    //   }\r\n    // },\r\n    drawGeoJSON () {\r\n      this.geojson = L.geoJSON(this.createVisiableAreaData(), {\r\n        style: this.style,\r\n        onEachFeature: this.onEachFeature\r\n      }).addTo(this.mymap)\r\n\r\n      // 設定時器更新geojson\r\n      for (let i = 0; i < this.locationGridArr.length; i++) {\r\n        this.updateLocalGeoJson(this.locationGridArr[i])\r\n      }\r\n    },\r\n    createVisiableAreaData () {\r\n      if (this.geojson) {\r\n        this.geojson.clearLayers()\r\n        this.collectionInfo = undefined\r\n        this.isCollectable = true\r\n      }\r\n      this.locationGridArr = []\r\n      this.CHECK_USER_COOLDOWN()\r\n      this.FILTER_MAPGRIDDATA()\r\n      let maxLat = Math.ceil(this.lat * 100) / 100\r\n      let maxLng = Math.ceil(this.lng * 100) / 100\r\n      let gap = 0.01\r\n      let range = Math.floor(this.userData.detectRange / 2)\r\n\r\n      for (let i = -range; i <= range; i++) {\r\n        for (let j = -range; j <= range; j++) {\r\n          let checkLat = Math.round((maxLat + (i * gap)) * 100) / 100\r\n          let checkLng = Math.round((maxLng + (j * gap)) * 100) / 100\r\n          // 找已儲存陣列中是否有符合的\r\n          const gridData = this.mapGridData.find(ele => {\r\n            return ele.properties.maxLat === checkLat && ele.properties.maxLng === checkLng\r\n          })\r\n          if (gridData) { // Global的mapGridData有該格資料\r\n            this.locationGridArr.push(gridData)\r\n          } else {\r\n            let basicGrid = {\r\n              'type': 'Feature',\r\n              'properties': {\r\n                'maxLat': checkLat,\r\n                'maxLng': checkLng,\r\n                'name': 'test',\r\n                'density': 0,\r\n                'respawnTime': null,\r\n                'storages': [\r\n                  {\r\n                    'type': '木頭',\r\n                    'amount': 2000\r\n                  },\r\n                  {\r\n                    'type': '石頭',\r\n                    'amount': 1600\r\n                  },\r\n                  {\r\n                    'type': '鋼鐵',\r\n                    'amount': 1000\r\n                  },\r\n                  {\r\n                    'type': '銅礦',\r\n                    'amount': 400\r\n                  }\r\n                ]\r\n              },\r\n              'geometry': {\r\n                'type': 'Polygon',\r\n                'coordinates': [\r\n                  [\r\n                    [checkLng, checkLat],\r\n                    [checkLng - gap, checkLat],\r\n                    [checkLng - gap, checkLat - gap],\r\n                    [checkLng, checkLat - gap],\r\n                    [checkLng, checkLat]\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n            this.locationGridArr.push(basicGrid)\r\n          }\r\n        }\r\n      }\r\n      return this.locationGridArr\r\n    },\r\n    style (feature) {\r\n      let remainStorage = 0\r\n      feature.properties.storages.map(ele => {\r\n        remainStorage += ele.amount\r\n      })\r\n      return {\r\n        fillColor: this.getColor(remainStorage * 100 / 5000),\r\n        weight: 2,\r\n        opacity: 1,\r\n        color: 'white',\r\n        dashArray: '3',\r\n        fillOpacity: 0.2\r\n      }\r\n    },\r\n    getColor (d) {\r\n      return d < 10 ? '#680A64'\r\n        : d < 20 ? '#8A2584'\r\n          : d < 40 ? '#A842A4'\r\n            : d < 60 ? '#C964C5'\r\n              : d < 80 ? '#E881E4'\r\n                : d < 100 ? '#FCA8FA'\r\n                  : '#FEDDFD'\r\n    },\r\n    highlightFeature (e) {\r\n      let maxLat = Math.ceil(this.lat * 100) / 100\r\n      let maxLng = Math.ceil(this.lng * 100) / 100\r\n      let layer = e.target\r\n\r\n      if (this.userData.isBeginner) {\r\n        if (!(layer.feature.properties.maxLat === maxLat && layer.feature.properties.maxLng === maxLng)) {\r\n          return\r\n        }\r\n        if (!this.nextScenes('gridData')) {\r\n          return\r\n        }\r\n      }\r\n      this.mymap.fitBounds(e.target.getBounds())\r\n      this.geojson.setStyle({\r\n        weight: 2,\r\n        opacity: 1,\r\n        color: 'white',\r\n        dashArray: '3',\r\n        fillOpacity: 0.2\r\n      })\r\n\r\n      layer.setStyle({\r\n        weight: 3,\r\n        color: '#666',\r\n        dashArray: '',\r\n        fillOpacity: 0.3\r\n      })\r\n\r\n      if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {\r\n        layer.bringToFront()\r\n      }\r\n\r\n      if (layer.feature.properties.maxLat === maxLat && layer.feature.properties.maxLng === maxLng) {\r\n        this.isCollectable = true\r\n      } else {\r\n        this.isCollectable = false\r\n      }\r\n      this.collectionInfo = layer.feature.properties\r\n    },\r\n    onEachFeature (feature, layer) {\r\n      layer.on({\r\n        click: this.highlightFeature\r\n      })\r\n    },\r\n    ifCollectable () {\r\n      let maxLat = Math.ceil(this.lat * 100) / 100\r\n      let maxLng = Math.ceil(this.lng * 100) / 100\r\n\r\n      this.CHECK_USER_COOLDOWN()\r\n      // 檢查是否有足夠的採集器\r\n      let collectorAmount = this.userData.collectorMax - this.userData.coolDownGrid.length\r\n      if (collectorAmount > 0) {\r\n        console.log('收集器足夠')\r\n        // 判斷該格有沒有在冷卻陣列中\r\n        let status = this.userData.coolDownGrid.some(ele => { return ele.maxLat === maxLat && ele.maxLng === maxLng })\r\n        if (status) { // 該格還在冷卻\r\n          console.log('還在冷卻')\r\n        } else {\r\n          this.collect()\r\n        }\r\n      } else {\r\n        console.log('收集器不夠')\r\n      }\r\n    },\r\n    collect () {\r\n      if (this.userData.isBeginner) {\r\n        if (!this.nextScenes('採集')) {\r\n          return\r\n        }\r\n      }\r\n      // 採集動畫與報告呈現\r\n      this.isCollecting = true\r\n\r\n      let maxLat = Math.ceil(this.lat * 100) / 100\r\n      let maxLng = Math.ceil(this.lng * 100) / 100\r\n      // 加到使用者自己冷卻陣列中\r\n      this.collectCoolDown({\r\n        maxLat: maxLat,\r\n        maxLng: maxLng,\r\n        finishTime: Date.now() + 10000\r\n      })\r\n      // 更改資料庫mapGridData資料\r\n      const gridData = this.mapGridData.find(ele => {\r\n        return ele.properties.maxLat === maxLat && ele.properties.maxLng === maxLng\r\n      })\r\n      if (gridData) { // 原本該格有存在資料庫中\r\n        gridData.properties.density++\r\n        this.storageToResource(gridData)\r\n      } else { // 原本沒存在，需要增加新的物件於陣列中，並刪除定量資源\r\n        let gap = 0.01\r\n        let newGrid = {\r\n          'type': 'Feature',\r\n          'properties': {\r\n            'maxLat': maxLat,\r\n            'maxLng': maxLng,\r\n            'name': 'test',\r\n            'density': 0,\r\n            'respawnTime': null,\r\n            'storages': [\r\n              {\r\n                'type': '木頭',\r\n                'amount': 2000\r\n              },\r\n              {\r\n                'type': '石頭',\r\n                'amount': 1600\r\n              },\r\n              {\r\n                'type': '鋼鐵',\r\n                'amount': 1000\r\n              },\r\n              {\r\n                'type': '銅礦',\r\n                'amount': 400\r\n              }\r\n            ]\r\n          },\r\n          'geometry': {\r\n            'type': 'Polygon',\r\n            'coordinates': [\r\n              [\r\n                [maxLng, maxLat],\r\n                [maxLng - gap, maxLat],\r\n                [maxLng - gap, maxLat - gap],\r\n                [maxLng, maxLat - gap],\r\n                [maxLng, maxLat]\r\n              ]\r\n            ]\r\n          }\r\n        }\r\n        newGrid.properties.density++\r\n        this.ADD_GRIDDATA(newGrid)\r\n        this.storageToResource(newGrid)\r\n      }\r\n      this.centerOn() // 回到定位中心\r\n    },\r\n    async storageToResource (gridData) {\r\n      const user = this.userData\r\n      const storages = gridData.properties.storages\r\n      let resources = []\r\n      storages.forEach((storage, index) => {\r\n        let addAmount = user.collectAbility * user.collectWeights[index].weights\r\n        if ((storage.amount - addAmount) < 0) {\r\n          addAmount = storage.amount\r\n        }\r\n        resources.push({\r\n          type: storage.type,\r\n          amount: addAmount\r\n        })\r\n      })\r\n      // await this.costResources({ gridData, resources })\r\n      this.COST_RESOURCES({ gridData, resources })\r\n      await this.$store.dispatch('user/collectResources', resources)\r\n      this.geojson.addData(this.createVisiableAreaData())\r\n      // this.shutdownGrid(gridData)\r\n    },\r\n    // shutdownGrid (gridData) {\r\n    //   let stillHaveStorages = gridData.properties.storages.filter(ele => ele.amount > 0).length\r\n    //   if (stillHaveStorages === 0) {\r\n    //     this.respawnGridData(gridData)\r\n    //     setTimeout(() => {\r\n    //       this.geojson.addData(this.createVisiableAreaData())\r\n    //     }, this.getRespawnTime)\r\n    //   }\r\n    // },\r\n    centerOn () {\r\n      this.mymap.panTo([this.lat, this.lng])\r\n    },\r\n    updateLocalGeoJson (data) {\r\n      if (data.properties.respawnTime !== null && data.properties.respawnTime >= Date.now()) {\r\n        console.log('大於')\r\n        let time = data.properties.respawnTime - Date.now()\r\n        setTimeout(() => {\r\n          this.geojson.addData(this.createVisiableAreaData())\r\n        }, time)\r\n      }\r\n    },\r\n    nextScenes (action) {\r\n      console.log(action, this.actions[this.currentScenes])\r\n      if (this.actions[this.currentScenes] === action) {\r\n        if (this.actions[this.currentScenes + 1] === '儲存') {\r\n          this.NEXT_SCENES()\r\n          this.$store.dispatch('user/nextScenes')\r\n          if (this.currentScenes === 40) {\r\n            this.$router.push('/beginner_guide')\r\n          }\r\n          return true\r\n        }\r\n        this.NEXT_SCENES()\r\n        return true\r\n      }\r\n      return false\r\n    },\r\n    closeReport (action) {\r\n      this.isCollecting = false\r\n      this.nextScenes(action)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n@import \"@/assets/scss/variables.scss\";\r\n.collect-root {\r\n  height: 100%;\r\n  width: 100%;\r\n  position: fixed;\r\n  color: black;\r\n  .cover-layer {\r\n    height: 100%;\r\n    width: 100%;\r\n    background: black;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    color: map-get($colors, white);\r\n    > img {\r\n      mix-blend-mode: screen;\r\n    }\r\n  }\r\n  #mapid {\r\n    height: 100%;\r\n    width: 100%;\r\n    z-index: 100;\r\n    /deep/ .marker-icon {\r\n      top: 0;\r\n      animation: markerMove 1s infinite;\r\n    }\r\n    @keyframes markerMove {\r\n      0% {\r\n        top: 0;\r\n      }\r\n      50% {\r\n        top: -5px;\r\n      }\r\n      100% {\r\n        top: 0;\r\n      }\r\n    }\r\n  }\r\n  .dialog {\r\n    /deep/ .dialog-wrapper {\r\n      background-color: map-get($colors, black);\r\n      span {\r\n        color: map-get($colors, black);\r\n      }\r\n      p {\r\n        color: #ffffff;\r\n      }\r\n    }\r\n  }\r\n  /deep/ .pointer-active {\r\n    .collection-info > div > button:nth-child(2) {\r\n      pointer-events: all;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BeginnerCollect.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BeginnerCollect.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BeginnerCollect.vue?vue&type=template&id=65bb8582&scoped=true&lang=pug&\"\nimport script from \"./BeginnerCollect.vue?vue&type=script&lang=js&\"\nexport * from \"./BeginnerCollect.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BeginnerCollect.vue?vue&type=style&index=0&id=65bb8582&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"65bb8582\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}